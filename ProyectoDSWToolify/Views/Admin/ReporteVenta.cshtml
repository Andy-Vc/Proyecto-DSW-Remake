@model IEnumerable<ProyectoDSWToolify.Models.ViewModels.ListadoVentaFechaAndTipoVentaDTO>

@{
    ViewData["Title"] = "Reporte de Ventas";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";

    string fechaInicio = Context.Request.Query["fechaInicio"];
    string fechaFin = Context.Request.Query["fechaFin"];
    string tipo = Context.Request.Query["tipo"];
    string tipoSeleccionado = Context.Request.Query["tipo"];
    bool esPresencial = tipoSeleccionado == "P";
    bool esRemota = tipoSeleccionado == "R";
}
<h1>Reporte de Ventas</h1>
<form asp-action="ReporteVenta" method="get">
    <div class="row g-3 align-items-end mb-3">
        <div class="col-md-3">
            <label for="fechaInicio">Fecha Inicio</label>
            <input type="date" id="fechaInicio" name="fechaInicio" class="form-control" value="@fechaInicio" />
        </div>
        <div class="col-md-3">
            <label for="fechaFin">Fecha Fin</label>
            <input type="date" id="fechaFin" name="fechaFin" class="form-control" value="@fechaFin" />
        </div>
        <div class="col-md-3">
            <label for="tipo">Tipo de Venta</label>
            <select name="tipo" id="tipo" class="form-control">
                <option value="" selected="@(string.IsNullOrEmpty(tipoSeleccionado))">--SELECCIONE--</option>
                <option value="P" selected="@(esPresencial)">Presencial</option>
                <option value="R" selected="@(esRemota)">Remota</option>
            </select>
        </div>
        <div class="col-md-3 d-flex flex-column flex-md-row gap-2">
            <button type="submit" class="btn btn-primary w-100 w-md-auto">
                Buscar <i class="fa-solid fa-magnifying-glass me-1 fa-beat"></i>
            </button>

            <a asp-action="ReporteVenta"
               asp-route-fechaInicio="@fechaInicio"
               asp-route-fechaFin="@fechaFin"
               asp-route-tipo="@tipo"
               asp-route-export="excel"
               class="btn btn-success w-100 w-md-auto">
                <i class="fa-solid fa-file-excel me-1 fa-beat"></i> Descargar Excel
            </a>

            <a asp-action="ReporteVenta"
               asp-route-fechaInicio="@fechaInicio"
               asp-route-fechaFin="@fechaFin"
               asp-route-tipo="@tipo"
               asp-route-export="pdf"
               class="btn btn-danger w-100 w-md-auto">
                <i class="fa-solid fa-file-pdf me-1 fa-beat"></i> Descargar PDF
            </a>
        </div>
    </div>
</form>

<table class="table table-bordered">
    <thead class="table-dark">
        <tr>
            <th>@Html.DisplayNameFor(model => model.First().idVenta)</th>
            <th>@Html.DisplayNameFor(model => model.First().nombresCompletos)</th>
            <th>@Html.DisplayNameFor(model => model.First().direccion)</th>
            <th>@Html.DisplayNameFor(model => model.First().fechaGenerada)</th>
            <th>@Html.DisplayNameFor(model => model.First().total)</th>
            <th>@Html.DisplayNameFor(model => model.First().estado)</th>
            <th>@Html.DisplayNameFor(model => model.First().tipoVenta)</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>@item.idVenta</td>
                <td>@item.nombresCompletos</td>
                <td>@item.direccion</td>
                <td>@item.fechaGenerada.ToString("yyyy-MM-dd")</td>
                <td>@item.total.ToString("C")</td>
                <td>@item.estado</td>
                <td>@item.tipoVenta</td>
            </tr>
        }
    </tbody>
</table>

<div class="text-center mt-3">
    @for (int pag = 1; pag <= ViewBag.numeroPag; pag++)
    {
        bool esActual = (ViewBag.pagActual == pag);
        <a asp-action="ReporteVenta"
           asp-route-pag="@pag"
           asp-route-fechaInicio="@fechaInicio"
           asp-route-fechaFin="@fechaFin"
           asp-route-tipo="@tipo"
           class="btn @(esActual ? "btn-danger" : "btn-outline-secondary")"
           style="@(esActual ? "pointer-events: none; background-color: darkred;" : "")">
            @pag
        </a>
    }
</div>
